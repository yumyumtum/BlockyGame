<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Cyclops Gamers Studio</title>
  <style>
    /* reset */
    html, body { margin:0; padding:0; height:100% }

    /* full-page background */
    body {
      background: url('cyclopsgamers.png') no-repeat center center fixed;
      background-size: cover;
      font-family: sans-serif;
      color: #fff;
      text-shadow: 1px 1px 2px #000;
    }

    /* dark overlay */
    .overlay {
      position: fixed; top:0; left:0;
      width:100%; height:100%;
      background: rgba(0,0,0,0.6);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    h1 { font-size: 4em; margin: 0.2em 0 }
    h2 { font-size: 2em; margin: 0.5em 0 1.2em }

    /* game-list */
    ul { list-style: none; padding: 0; margin: 0 }
    li { padding: 0 }

    /* button-style links */
    a {
      display: inline-block;
      margin: 0.6em 0;
      padding: 0.5em 1em;
      color: #0f0;
      text-decoration: none;
      font-size: 1.3em;
      border: 2px solid #0f0;
      border-radius: 0.4em;
      transition: background 0.2s;
    }
    a:hover {
      background: rgba(0,255,0,0.2);
    }
    a:focus { outline: none }
  </style>
</head>
<body>
  <div class="overlay">
    <h1>Cyclops Gamers</h1>
    <h2>Select Your Game</h2>
    <ul id="game-list">
      <li>Loading gamesâ€¦</li>
    </ul>
  </div>

  <script>
    async function detectGames() {
      // fallback when we're on file:// or scraping fails
      const known = ['Dodge_Games','SpaceShip','DuckAdventure','FlappyPoop','SniperGame','Trivia'];
      let dirs = [];

      // attempt HTTP directory scrape (only works if you host it with dir-indexes enabled)
      try {
        const res = await fetch('.', { cache: 'no-store' });
        const txt = await res.text();
        const re  = /href="([^"/]+)\/"/g;
        const set = new Set();
        let  m;
        while ((m = re.exec(txt)) !== null) {
          if (!m[1].startsWith('.')) set.add(m[1]);
        }
        dirs = Array.from(set);
      } catch {
        // ignore
      }

      if (dirs.length === 0) dirs = known;

      // if file://, skip the HEAD test (it won't work locally)
      if (window.location.protocol === 'file:') {
        return dirs;
      }

      // otherwise confirm index.html actually exists
      const good = [];
      for (const d of dirs) {
        try {
          const h = await fetch(`./${d}/index.html`, { method: 'HEAD' });
          if (h.ok) good.push(d);
        } catch {}
      }
      return good;
    }

    window.addEventListener('DOMContentLoaded', async () => {
      const list  = document.getElementById('game-list');
      const games = await detectGames();
      list.innerHTML = '';

      if (games.length === 0) {
        list.innerHTML = '<li>No games found.</li>';
        return;
      }

      for (const g of games) {
        const li = document.createElement('li');
        const a  = document.createElement('a');

        // **point directly** at the index.html
        a.href         = `./${g}/index.html`;
        a.textContent  = g.replace(/_/g,' ');
        li.appendChild(a);
        list.appendChild(li);
      }
    });
  </script>
</body>
</html>
